FROM alpine:3.18

# Install PostgreSQL client
RUN apk --no-cache add postgresql-client bash

# Set working directory
WORKDIR /app

# Copy migration scripts
COPY scripts/migrations /app/scripts/migrations
COPY scripts/migrate.sh /app/scripts/migrate.sh

# Make scripts executable
RUN chmod +x /app/scripts/migrate.sh

# Set environment variables
ENV DB_HOST=postgres
ENV DB_PORT=5432
ENV DB_USER=postgres
ENV DB_PASSWORD=postgres
ENV DB_NAME=rabona

# Run migrations
CMD ["/app/scripts/migrate.sh"] 