import{M as D,_ as z,r as m,d as P,w as L,o as M,J as W,L as A,V as r,Z as p,S as t,X as w,i as v,T as G,W as J,F as K}from"./index-C-zGrUoI.js";import{a as V,Q as X,b as Z}from"./QCheckbox-sUkhWEf0.js";import{Q as $}from"./QTd-B3U1dHsZ.js";import{Q as E}from"./QTable-BHAfpKVc.js";import{Q as H,a as h}from"./QCard-DOI4ZXPZ.js";import{Q as Y,a as c}from"./QForm-Cl11kOIE.js";import{Q as _}from"./QPage-CvRq0xGa.js";import{C as x}from"./ClosePopup-DX7zifc8.js";import{u as ee}from"./use-quasar-CxyViSnp.js";import{P as B}from"./graphql-BhlZu-4f.js";import{u as ae,g as le,a as q,b as te}from"./players-CmO3y9R_.js";import{u as oe}from"./teamService-CeYuJnEL.js";import{T as re}from"./TeamLogo-BOeFWqum.js";import{u as se}from"./vue-i18n.runtime-DVqvX0-m.js";import"./use-prevent-scroll-vJLFi8tH.js";import"./use-dark-Ckxuwpjg.js";import"./format-DJ6joreN.js";import"./scroll-D24tlZTm.js";import"./QList-ymlTHANC.js";import"./private.use-form-BxgRZ4S9.js";import"./index-DzDBEjQp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ie={class:"row items-center justify-between q-mb-md"},ne={class:"text-h4 q-my-none"},ue={class:"q-mb-md"},me={class:"text-h6"},de={class:"row justify-end q-mt-md"},Ie=D({__name:"PlayersPage",setup(pe){const{t:s}=se(),y=ee(),C=z(),N=oe(),i=ae(),b=m(!1),d=m(!1),n=m(null),g=m({page:1,rowsPerPage:10}),o=m({firstName:"",lastName:"",dateOfBirth:"",position:B.Undefined,nationality:"",teamId:void 0,imageUrl:void 0}),F=[{name:"team_logo",label:s("players.table.team"),field:"team_id",align:"center"},{name:"name",label:s("players.table.name"),field:e=>le(e),align:"left",sortable:!0},{name:"position",label:s("players.table.position"),field:e=>e.position,format:e=>e,sortable:!0,sort:(e,l)=>q(e)-q(l),align:"center"},{name:"nationality",label:s("players.table.nationality"),field:"nationality",align:"left"},{name:"dateOfBirth",label:s("players.table.dateOfBirth"),field:"dateOfBirth",align:"left",sortable:!0},{name:"jerseyNumber",label:s("players.table.jersey"),field:"jerseyNumber",align:"center"},{name:"actions",label:s("players.table.actions"),field:"actions",align:"center"}],Q=P(()=>N.teams||[]),T=P(()=>[{label:s("players.allTeams"),value:null},...(Q.value||[]).map(e=>({label:e.name,value:String(e.id)}))]),u=m(null),U=P(()=>i.players?u.value?i.getPlayersByTeam(u.value):i.players:[]),f=async()=>{b.value=!0;try{u.value?await i.fetchPlayersByTeam(u.value):await i.fetchPlayers()}catch(e){console.error("Failed to load players:",e),y.notify({color:"negative",message:"Failed to load players",icon:"error"})}finally{b.value=!1}},O=async e=>{g.value.page=e.pagination.page,g.value.rowsPerPage=e.pagination.rowsPerPage,await f()},S=()=>{n.value=null,k(),d.value=!0},R=e=>{n.value=e,o.value={...e},d.value=!0},k=()=>{o.value={firstName:"",lastName:"",dateOfBirth:"",position:B.Undefined,nationality:"",teamId:void 0,imageUrl:void 0}},I=async()=>{var e;try{(e=n.value)!=null&&e.id?await i.updatePlayer({...o.value,id:n.value.id}):await i.createPlayer(o.value),d.value=!1,await f(),y.notify({color:"positive",message:`Player ${n.value?"updated":"created"} successfully`,icon:"check"})}catch(l){console.error("Failed to save player:",l),y.notify({color:"negative",message:`Failed to ${n.value?"update":"create"} player`,icon:"error"})}},j=(e,l)=>{C.push(`/players/${l.id}`)};return L(u,async()=>{await f()}),M(async()=>{try{await Promise.all([N.fetchTeams(),f()])}catch(e){console.error("Failed to initialize data:",e),y.notify({color:"negative",message:"Failed to initialize data",icon:"error"})}}),(e,l)=>(A(),W(_,{padding:""},{default:r(()=>[p("div",ie,[p("h1",ne,w(e.$t("players.title")),1),t(v,{color:"primary",icon:"add",label:e.$t("players.addPlayer"),onClick:S},null,8,["label"])]),p("div",ue,[t(V,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=a=>u.value=a),options:T.value,label:e.$t("players.filterByTeam"),"option-value":"value",clearable:"","emit-value":"","map-options":"",style:{width:"300px"}},null,8,["modelValue","options","label"])]),t(E,{rows:U.value,columns:F,"row-key":"id",loading:b.value,pagination:g.value,onRequest:O,onRowClick:j,"binary-state-sort":""},{"body-cell-team_logo":r(a=>[t($,{props:a,class:"text-center"},{default:r(()=>[t(re,{"team-id":a.row.teamId,size:"md"},null,8,["team-id"])]),_:2},1032,["props"])]),"body-cell-position":r(a=>[t($,{props:a},{default:r(()=>[t(X,{color:G(te)(a.row.position),"text-color":"white",size:"sm"},{default:r(()=>[J(w(e.$t(`players.positions.${a.row.position.toLowerCase()}`)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-actions":r(a=>[t($,{props:a,class:"q-gutter-sm"},{default:r(()=>[t(v,{flat:"",round:"",color:"primary",icon:"edit",onClick:ye=>R(a.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"]),t(Z,{modelValue:d.value,"onUpdate:modelValue":l[7]||(l[7]=a=>d.value=a),persistent:""},{default:r(()=>[t(H,{style:{"min-width":"350px"}},{default:r(()=>[t(h,null,{default:r(()=>[p("div",me,w(n.value?e.$t("players.editPlayer"):e.$t("players.addPlayer")),1)]),_:1}),t(h,null,{default:r(()=>[t(Y,{onSubmit:I,class:"q-gutter-md"},{default:r(()=>[t(c,{modelValue:o.value.firstName,"onUpdate:modelValue":l[1]||(l[1]=a=>o.value.firstName=a),label:e.$t("players.form.firstName"),rules:[a=>!!a||e.$t("players.form.firstNameRequired")]},null,8,["modelValue","label","rules"]),t(c,{modelValue:o.value.lastName,"onUpdate:modelValue":l[2]||(l[2]=a=>o.value.lastName=a),label:e.$t("players.form.lastName"),rules:[a=>!!a||e.$t("players.form.lastNameRequired")]},null,8,["modelValue","label","rules"]),t(c,{modelValue:o.value.dateOfBirth,"onUpdate:modelValue":l[3]||(l[3]=a=>o.value.dateOfBirth=a),label:e.$t("players.form.dateOfBirth"),type:"date",rules:[a=>!!a||e.$t("players.form.dateOfBirthRequired")]},null,8,["modelValue","label","rules"]),t(V,{modelValue:o.value.position,"onUpdate:modelValue":l[4]||(l[4]=a=>o.value.position=a),options:["GK","DF","MF","FW"],label:e.$t("players.form.position"),rules:[a=>!!a||e.$t("players.form.positionRequired")]},null,8,["modelValue","label","rules"]),t(c,{modelValue:o.value.nationality,"onUpdate:modelValue":l[5]||(l[5]=a=>o.value.nationality=a),label:e.$t("players.form.nationality"),rules:[a=>!!a||e.$t("players.form.nationalityRequired")]},null,8,["modelValue","label","rules"]),t(V,{modelValue:o.value.teamId,"onUpdate:modelValue":l[6]||(l[6]=a=>o.value.teamId=a),options:Q.value,"option-value":"id","option-label":"name",label:e.$t("players.form.team"),rules:[a=>!!a||e.$t("players.form.teamRequired")]},null,8,["modelValue","options","label","rules"]),p("div",de,[K(t(v,{label:e.$t("common.cancel"),color:"primary",flat:""},null,8,["label"]),[[x]]),t(v,{label:e.$t("common.save"),type:"submit",color:"primary",class:"q-ml-sm"},null,8,["label"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{Ie as default};
