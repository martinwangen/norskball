import{d as I,a1 as A,r as u,c as b,w as $,o as j,S as z,U as L,V as i,a0 as m,f as t,y as c,Z as M,X as R,Y as Q,M as E}from"./index-Cm6bZCtb.js";import{a as P,Q as G,b as J}from"./QCheckbox-DErdi7or.js";import{Q as w}from"./QTd-B2b-7SvT.js";import{Q as K}from"./QTable-DI5yNRlB.js";import{Q as W,a as q}from"./QCard-Bu511efH.js";import{Q as X,a as y}from"./QForm-cxEm4fb9.js";import{Q as Y}from"./QPage-BiUDp_G9.js";import{C as Z}from"./ClosePopup-DBJUmWnX.js";import{u as H}from"./use-quasar-BjZ55HgA.js";import{P as F}from"./graphql-DMYS3sVo.js";import{u as ee,g as ae,a as le,b as T}from"./players-Cb9Sk1ng.js";import{u as te}from"./teamService-CHfQ816M.js";import{T as oe}from"./TeamLogo-D5majQd7.js";import"./use-prevent-scroll-BbUsLF7j.js";import"./use-dark-CkpHGi7m.js";import"./QList-C25ZtbNJ.js";import"./scroll-LBgmWIJC.js";import"./private.use-form-Bt6FDSoW.js";import"./format-hlGAdIUH.js";import"./QSeparator-DLr0b9gN.js";import"./_plugin-vue_export-helper-CxHgfykZ.js";const ie={class:"row items-center justify-between q-mb-md"},re={class:"q-mb-md"},se={class:"text-h6"},ne={class:"row justify-end q-mt-md"},_e=I({__name:"PlayersPage",setup(ue){const p=H(),h=A(),V=te(),r=ee(),v=u(!1),d=u(!1),s=u(null),g=u({page:1,rowsPerPage:10}),o=u({firstName:"",lastName:"",dateOfBirth:"",position:F.Undefined,nationality:"",teamId:void 0,imageUrl:void 0}),B=[{name:"team_logo",label:"Team",field:"team_id",align:"center"},{name:"name",label:"Name",field:a=>ae(a),align:"left",sortable:!0},{name:"position",label:"Position",field:a=>a.position,format:a=>a,sortable:!0,sort:(a,l)=>T(a)-T(l),align:"center"},{name:"nationality",label:"Nationality",field:"nationality",align:"left"},{name:"dateOfBirth",label:"Date of Birth",field:"dateOfBirth",align:"left",sortable:!0},{name:"jerseyNumber",label:"Jersey",field:"jerseyNumber",align:"center"},{name:"actions",label:"Actions",field:"actions",align:"center"}],N=b(()=>V.teams||[]),C=b(()=>[{label:"All Teams",value:null},...(N.value||[]).map(a=>({label:a.name,value:String(a.id)}))]),n=u(null),U=b(()=>r.players?n.value?r.getPlayersByTeam(n.value):r.players:[]),f=async()=>{v.value=!0;try{n.value?await r.fetchPlayersByTeam(n.value):await r.fetchPlayers()}catch(a){console.error("Failed to load players:",a),p.notify({color:"negative",message:"Failed to load players",icon:"error"})}finally{v.value=!1}},S=async a=>{g.value.page=a.pagination.page,g.value.rowsPerPage=a.pagination.rowsPerPage,await f()},_=()=>{s.value=null,k(),d.value=!0},x=a=>{s.value=a,o.value={...a},d.value=!0},k=()=>{o.value={firstName:"",lastName:"",dateOfBirth:"",position:F.Undefined,nationality:"",teamId:void 0,imageUrl:void 0}},D=async()=>{var a;try{(a=s.value)!=null&&a.id?await r.updatePlayer({...o.value,id:s.value.id}):await r.createPlayer(o.value),d.value=!1,await f(),p.notify({color:"positive",message:`Player ${s.value?"updated":"created"} successfully`,icon:"check"})}catch(l){console.error("Failed to save player:",l),p.notify({color:"negative",message:`Failed to ${s.value?"update":"create"} player`,icon:"error"})}},O=(a,l)=>{h.push(`/players/${l.id}`)};return $(n,async()=>{await f()}),j(async()=>{try{await Promise.all([V.fetchTeams(),f()])}catch(a){console.error("Failed to initialize data:",a),p.notify({color:"negative",message:"Failed to initialize data",icon:"error"})}}),(a,l)=>(L(),z(Y,{padding:""},{default:i(()=>[m("div",ie,[l[8]||(l[8]=m("h1",{class:"text-h4 q-my-none"},"Players",-1)),t(c,{color:"primary",icon:"add",label:"Add Player",onClick:_})]),m("div",re,[t(P,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value=e),options:C.value,label:"Filter by Team","option-value":"value",clearable:"","emit-value":"","map-options":"",style:{width:"300px"}},null,8,["modelValue","options"])]),t(K,{rows:U.value,columns:B,"row-key":"id",loading:v.value,pagination:g.value,onRequest:S,onRowClick:O,"binary-state-sort":""},{"body-cell-team_logo":i(e=>[t(w,{props:e,class:"text-center"},{default:i(()=>[t(oe,{"team-id":e.row.teamId,size:"md"},null,8,["team-id"])]),_:2},1032,["props"])]),"body-cell-position":i(e=>[t(w,{props:e},{default:i(()=>[t(G,{color:M(le)(e.row.position),"text-color":"white",size:"sm"},{default:i(()=>[R(Q(e.row.position),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-actions":i(e=>[t(w,{props:e,class:"q-gutter-sm"},{default:i(()=>[t(c,{flat:"",round:"",color:"primary",icon:"edit",onClick:de=>x(e.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"]),t(J,{modelValue:d.value,"onUpdate:modelValue":l[7]||(l[7]=e=>d.value=e),persistent:""},{default:i(()=>[t(W,{style:{"min-width":"350px"}},{default:i(()=>[t(q,null,{default:i(()=>[m("div",se,Q(s.value?"Edit Player":"Add Player"),1)]),_:1}),t(q,null,{default:i(()=>[t(X,{onSubmit:D,class:"q-gutter-md"},{default:i(()=>[t(y,{modelValue:o.value.firstName,"onUpdate:modelValue":l[1]||(l[1]=e=>o.value.firstName=e),label:"First Name",rules:[e=>!!e||"First name is required"]},null,8,["modelValue","rules"]),t(y,{modelValue:o.value.lastName,"onUpdate:modelValue":l[2]||(l[2]=e=>o.value.lastName=e),label:"Last Name",rules:[e=>!!e||"Last name is required"]},null,8,["modelValue","rules"]),t(y,{modelValue:o.value.dateOfBirth,"onUpdate:modelValue":l[3]||(l[3]=e=>o.value.dateOfBirth=e),label:"Date of Birth",type:"date",rules:[e=>!!e||"Date of birth is required"]},null,8,["modelValue","rules"]),t(P,{modelValue:o.value.position,"onUpdate:modelValue":l[4]||(l[4]=e=>o.value.position=e),options:["GK","DF","MF","FW"],label:"Position",rules:[e=>!!e||"Position is required"]},null,8,["modelValue","rules"]),t(y,{modelValue:o.value.nationality,"onUpdate:modelValue":l[5]||(l[5]=e=>o.value.nationality=e),label:"Nationality",rules:[e=>!!e||"Nationality is required"]},null,8,["modelValue","rules"]),t(P,{modelValue:o.value.teamId,"onUpdate:modelValue":l[6]||(l[6]=e=>o.value.teamId=e),options:N.value,"option-value":"id","option-label":"name",label:"Team",rules:[e=>!!e||"Team is required"]},null,8,["modelValue","options","rules"]),m("div",ne,[E(t(c,{label:"Cancel",color:"primary",flat:""},null,512),[[Z]]),t(c,{label:"Save",type:"submit",color:"primary",class:"q-ml-sm"})])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{_e as default};
